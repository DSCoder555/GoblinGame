<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
        var pile1 = 3;
        var pile2 = 3;
        var pile3 = 3;
        var isPlayerTurn = false;
        var gameOver = false;
        function start(){
            pile1 = 3;
            pile2 = 3;
            pile3 = 3;
            isPlayerTurn = false;
            gameOver = false;
            display();
        }
        function takeStone(pileNum,count){
            if(pileNum == 1){
                if(count > pile1){
                    return false;
                }
                else{
                    pile1 -= count;
                    return true;
                }
            }
            else if(pileNum == 2){
                if(count > pile2){
                    return false;
                }
                else{
                    pile2 -= count;
                    return true;
                }
            }
            else{
                if(count > pile3){
                    return false;
                }
                else{
                    pile3 -= count;
                    return true;
                }
            }
        }
        function goblinTurn(){
            if(gameOver){
                document.getElementById("warning").innerHTML = "The game is over";
            }
            else if(!isPlayerTurn){
                if(pile1>=pile2 && pile1>=pile3){
                    takeStone(1,1);
                }
                else if(pile2>= pile3){
                    takeStone(2,1);
                }
                else{
                    takeStone(3,1);
                }
                isPlayerTurn = true;
                display();
                if(check()){
                    document.getElementById("warning").innerHTML = "The game is over.  You won, the goblins lost.";
                }
            }
            else{
                document.getElementById("warning").innerHTML = "It is your turn";
            }
        }
        function display(){
            lines = "";
            for(i = 3; i > 0; i--){
                if(pile1 >= i){
                    lines += "O";
                }
                else{
                    lines += "X";
                }
                lines += " ";
                if(pile2 >= i){
                    lines += "O";
                }
                else{
                    lines += "X";
                }
                lines += " ";
                if(pile3 >= i){
                    lines += "O";
                }
                else{
                    lines += "X";
                }
                lines += "<br>";
            }
            document.getElementById("display").innerHTML = lines;
        }
        function playerTurn(pileNum,count){
            if(gameOver){
                document.getElementById("warning").innerHTML = "The game is over";
            }
            else if(isPlayerTurn){
                if(takeStone(pileNum,count)){
                    document.getElementById("warning").innerHTML = "";
                    display();
                    isPlayerTurn = false;
                    if(check()){
                        document.getElementById("warning").innerHTML = "The ganme is over.  You lost, the goblins won.";
                    }
                }
                else{
                    document.getElementById("warning").innerHTML = "That move is not possible";
                }
            }
            else{
                document.getElementById("warning").innerHTML = "It is not your turn.";
            }
        }
        function check(){
            if(pile1 == 0 && pile2 == 0 && pile3 == 0){
                gameOver = true;
            }
        }
    </script>
</head>
<body onload="display()">
    <h1>Goblin Game!</h1>
    <p id="display"></p>
    <button onclick="playerTurn(1,1)">Stack 1:1</button>
    <button onclick="playerTurn(1,2)">Stack 1:2</button>
    <button onclick="playerTurn(1,3)">Stack 1:3</button>
    <button onclick="playerTurn(2,1)">Stack 2:1</button>
    <button onclick="playerTurn(2,2)">Stack 2:2</button>
    <button onclick="playerTurn(2,3)">Stack 2:3</button>
    <button onclick="playerTurn(3,1)">Stack 3:1</button>
    <button onclick="playerTurn(3,2)">Stack 3:2</button>
    <button onclick="playerTurn(3,3)">Stack 3:3</button>
    <p id="warning"></p>
    <button onclick="goblinTurn()">Goblin's turn</button>
</body>
</html>